<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Inventario de Flores - FloraGest</title>
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    /* Men√∫ superior */
    #menuUsuario {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: var(--color-primary);
      color: white;
      padding: 10px 20px;
      z-index: 5;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    #menuUsuario button {
      background-color: var(--color-danger);
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }

    #menuUsuario button:hover {
      background-color: #c0392b;
    }

    body {
      padding-top: 60px;
    }
  </style>
</head>
<body>
  <!-- Men√∫ de usuario -->
  <div id="menuUsuario">
    
    <button onclick="cerrarSesion()">Cerrar Sesi√≥n</button>
  </div>

  <h1>üåº Inventario de Flores</h1>

  <!-- Formulario de agregar flores -->
  <form id="formFlor">
    <input type="text" id="nombre" placeholder="Nombre" required>
    <input type="text" id="color" placeholder="Color" required>
    <input type="number" id="stock" placeholder="Stock" required>
    <input type="number" step="0.01" id="precio" placeholder="Precio" required>
    <button type="submit">Agregar Flor</button>
  </form>

  <!-- Tabla de flores -->
  <table>
    <thead>
      <tr><th>ID</th><th>Nombre</th><th>Color</th><th>Stock</th><th>Precio</th><th>Acciones</th></tr>
    </thead>
    <tbody id="tablaFlores"></tbody>
  </table>

  <script>
    // --- CRUD de flores ---
    async function cargarFlores() {
      const res = await fetch('/api/flores');
      const data = await res.json();
      const tbody = document.getElementById('tablaFlores');
      tbody.innerHTML = '';
      data.forEach(flor => {
        tbody.innerHTML += `
          <tr>
            <td>${flor.id}</td>
            <td>${flor.nombre}</td>
            <td>${flor.color}</td>
            <td>${flor.stock}</td>
            <td>$${flor.precio}</td>
            <td>
              <button onclick="eliminarFlor(${flor.id})">üóëÔ∏è</button>
            </td>
          </tr>`;
      });
    }

    document.getElementById('formFlor').addEventListener('submit', async e => {
      e.preventDefault();
      const flor = {
        nombre: nombre.value,
        color: color.value,
        stock: parseInt(stock.value),
        precio: parseFloat(precio.value)
      };
      const res = await fetch('/api/flores', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(flor)
      });
      const data = await res.json();
      alert(data.mensaje);
      cargarFlores();
      e.target.reset();
    });

    async function eliminarFlor(id) {
      if (confirm("¬øEliminar esta flor?")) {
        const res = await fetch(`/api/flores/${id}`, { method: 'DELETE' });
        const data = await res.json();
        alert(data.mensaje);
        cargarFlores();
      }
    }

    cargarFlores();

    // --- Cerrar sesi√≥n ---
    function cerrarSesion() {
      window.location.href = "/";
    }
  </script>
</body>
</html>
